#!/bin/sh

while true
do
	MUTED="$(amixer get Master | grep 'Left:' | awk '{ print ($6) }')"

	if [ "$MUTED" = "[off]" ]
	then
		VOL="MUTED"
	else
		VOL="$(amixer -D pulse sget Master | grep 'Left:' | awk -F'[][]' '{ print $2 }')"
	fi

	BRIGHT="$(xbacklight | cut -f1 -d'.')"
	BAT0="$(cat /sys/class/power_supply/BAT0/capacity)"
	BAT1="$(cat /sys/class/power_supply/BAT1/capacity)"
	DATE="$(date '+%m-%d-%Y - %H:%M')"
	MIC="$(amixer get Capture | grep 'Left:' | awk '{print ($6)}' | sed 's/[][]//g' | tr a-z A-Z )"

	MESSAGE="[M: ${MIC}] [V: ${VOL}] [B: ${BRIGHT}%] [0: ${BAT0}% 1: ${BAT1}%] ${DATE}"

	xsetroot -name "${MESSAGE}"
	sleep 1
done &

# wut
export _JAVA_AWT_WM_NONREPARENTING=1


exec dwm
